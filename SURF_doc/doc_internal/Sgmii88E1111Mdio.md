# Entity: Sgmii88E1111Mdio

- **File**: Sgmii88E1111Mdio.vhd
## Diagram

![Diagram](Sgmii88E1111Mdio.svg "Diagram")
## Description

Company    : SLAC National Accelerator Laboratory
Description: Controller for the Marvell 88E1111 PHY
This file is part of 'SLAC Firmware Standard Library'.
It is subject to the license terms in the LICENSE.txt file found in the
top-level directory of this distribution and at:
   https://confluence.slac.stanford.edu/display/ppareg/LICENSE.html.
No part of 'SLAC Firmware Standard Library', including this file,
may be copied, modified, propagated, or distributed except according to
the terms contained in the LICENSE.txt file.
## Generics

| Generic name | Type                            | Value | Description                       |
| ------------ | ------------------------------- | ----- | --------------------------------- |
| TPD_G        | time                            | 1 ns  |                                   |
| DIV_G        | natural range 1 to natural'high | 1     | half-period of MDC in clk cycles  |
| PHY_G        | natural range 0 to 31           | 7     |                                   |
## Ports

| Port name       | Direction | Type | Description                  |
| --------------- | --------- | ---- | ---------------------------- |
| clk             | in        | sl   | clock and reset              |
| rst             | in        | sl   |                              |
| initDone        | out       | sl   | misc                         |
| speed_is_10_100 | out       | sl   |                              |
| speed_is_100    | out       | sl   |                              |
| linkIsUp        | out       | sl   |                              |
| mdc             | out       | sl   | MDIO interface               |
| mdo             | out       | sl   |                              |
| mdi             | in        | sl   |                              |
| linkIrq         | in        | sl   | link status change interrupt |
## Signals

| Name     | Type                                 | Description |
| -------- | ------------------------------------ | ----------- |
| r        | RegType                              |             |
| rin      | RegType                              |             |
| hdlrDone | sl                                   |             |
| args     | Slv16Array(0 to NUM_READ_ARGS_C - 1) |             |
## Constants

| Name            | Type             | Value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Description                                                                                                               |
| --------------- | ---------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------- |
| P_INIT_C        | MdioProgramArray |        (          mdioWriteInst(PHY_G,<br><span style="padding-left:20px"> 22,<br><span style="padding-left:20px"> X"0001",<br><span style="padding-left:20px"> false),<br><span style="padding-left:20px">  -- select page 1          mdioWriteInst(PHY_G,<br><span style="padding-left:20px"> 0,<br><span style="padding-left:20px"> X"0140",<br><span style="padding-left:20px"> false),<br><span style="padding-left:20px">  -- disable ANEG on SMII side          mdioWriteInst(PHY_G,<br><span style="padding-left:20px"> 22,<br><span style="padding-left:20px"> X"0000",<br><span style="padding-left:20px"> false),<br><span style="padding-left:20px">  -- select page 0          mdioWriteInst(PHY_G,<br><span style="padding-left:20px"> 4,<br><span style="padding-left:20px"> X"0140",<br><span style="padding-left:20px"> false),<br><span style="padding-left:20px">  -- advertise 10/100 FD only          mdioWriteInst(PHY_G,<br><span style="padding-left:20px"> 9,<br><span style="padding-left:20px"> X"0200",<br><span style="padding-left:20px"> false),<br><span style="padding-left:20px">  -- advertise 1000   FD only          mdioWriteInst(PHY_G,<br><span style="padding-left:20px"> 18,<br><span style="padding-left:20px"> X"0c00",<br><span style="padding-left:20px"> false),<br><span style="padding-left:20px">  -- enable link status and ANEG IRQ          mdioWriteInst(PHY_G,<br><span style="padding-left:20px"> 0,<br><span style="padding-left:20px"> X"1340",<br><span style="padding-left:20px"> true)    -- restart copper ANEG          ) |                                                                                                                           |
| REG19_IDX_C     | natural          |  0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                           |
| REG17_IDX_C     | natural          |  1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                           |
| P_HDLR_C        | MdioProgramArray |        (          REG19_IDX_C => mdioReadInst(PHY_G,<br><span style="padding-left:20px"> 19,<br><span style="padding-left:20px"> false),<br><span style="padding-left:20px">  -- read/ack/clear interrupt          REG17_IDX_C => mdioReadInst(PHY_G,<br><span style="padding-left:20px"> 17,<br><span style="padding-left:20px"> true)  -- read current speed and link status          )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | IRQ Handler sequence: 1) read back and clear interrupts (reading does clear them) 2) obtain current link status and speed |
| NUM_READ_ARGS_C | natural          |  mdioProgNumReadTransactions(P_HDLR_C)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                           |
| REG_INIT_C      | RegType          |  (       s10_100  => '0',<br><span style="padding-left:20px">       s100     => '0',<br><span style="padding-left:20px">       linkIsUp => '0'       )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                           |
## Types

| Name    | Type | Description |
| ------- | ---- | ----------- |
| RegType |      |             |
## Processes
- COMB: ( args, hdlrDone, r )
- SEQ: ( clk )
## Instantiations

- U_MdioLinkIrqHandler: surf.MdioLinkIrqHandler
