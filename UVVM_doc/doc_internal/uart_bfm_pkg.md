# Package: uart_bfm_pkg

- **File**: uart_bfm_pkg.vhd
## Description

=================================================================================================

## Constants

| Name                                    | Type                  | Value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Description |
| --------------------------------------- | --------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------- |
| C_SCOPE                                 | string                |  "UART BFM"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |             |
| C_DATA_MAX_LENGTH                       | natural               |  8                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |             |
| C_EXPECT_RECEIVED_DATA_STRING_SEPARATOR | string                |  ";<br><span style="padding-left:20px"> "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |             |
| C_BFM_ERROR_INJECTION_INACTIVE          | t_bfm_error_injection |  (     parity_bit_error  => false,<br><span style="padding-left:20px">     stop_bit_error    => false   )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |             |
| C_UART_BFM_CONFIG_DEFAULT               | t_uart_bfm_config     |  (     bit_time                                  => -1 ns,<br><span style="padding-left:20px">     num_data_bits                             => 8,<br><span style="padding-left:20px">     idle_state                                => '1',<br><span style="padding-left:20px">     num_stop_bits                             => STOP_BITS_ONE,<br><span style="padding-left:20px">     parity                                    => PARITY_ODD,<br><span style="padding-left:20px">     timeout                                   => 0 ns,<br><span style="padding-left:20px">                -- will default never time out     timeout_severity                          => error,<br><span style="padding-left:20px">     num_bytes_to_log_before_expected_data     => 10,<br><span style="padding-left:20px">     match_strictness                          => MATCH_EXACT,<br><span style="padding-left:20px">     id_for_bfm                                => ID_BFM,<br><span style="padding-left:20px">     id_for_bfm_wait                           => ID_BFM_WAIT,<br><span style="padding-left:20px">     id_for_bfm_poll                           => ID_BFM_POLL,<br><span style="padding-left:20px">     id_for_bfm_poll_summary                   => ID_BFM_POLL_SUMMARY,<br><span style="padding-left:20px">     error_injection                           => C_BFM_ERROR_INJECTION_INACTIVE     ) |             |
## Types

| Name                            | Type                                                                       | Description |
| ------------------------------- | -------------------------------------------------------------------------- | ----------- |
| uart_expect_received_data_array | array (natural range<>) of std_logic_vector(C_DATA_MAX_LENGTH-1 downto 0)  |             |
| t_bfm_error_injection           |                                                                            |             |
| t_uart_bfm_config               |                                                                            |             |
## Functions
- uart_transmit <font id="function_arguments">( constant data_value         : in  std_logic_vector;<br><span style="padding-left:20px"> constant msg                : in  string;<br><span style="padding-left:20px"> signal tx                   : inout std_logic;<br><span style="padding-left:20px"> constant config             : in  t_uart_bfm_config  := C_UART_BFM_CONFIG_DEFAULT;<br><span style="padding-left:20px"> constant scope              : in  string             := C_SCOPE;<br><span style="padding-left:20px"> constant msg_id_panel       : in  t_msg_id_panel     := shared_msg_id_panel ) </font> <font id="function_return">return ()</font>
</br>**Description**
--------------------------------------------------
 BFM procedures
--------------------------------------------------
----------------------------------------
 uart_transmit
----------------------------------------
 - This procedure transmits data 'data_value' to the UART DUT
 - The TX configuration can be set in the config parameter

- uart_receive <font id="function_arguments">( variable data_value         : out std_logic_vector;<br><span style="padding-left:20px"> constant msg                : in  string;<br><span style="padding-left:20px"> signal rx                   : in  std_logic;<br><span style="padding-left:20px"> signal terminate_loop       : in  std_logic;<br><span style="padding-left:20px"> constant config             : in  t_uart_bfm_config := C_UART_BFM_CONFIG_DEFAULT;<br><span style="padding-left:20px"> constant scope              : in  string            := C_SCOPE;<br><span style="padding-left:20px"> constant msg_id_panel       : in  t_msg_id_panel    := shared_msg_id_panel;<br><span style="padding-left:20px"> constant ext_proc_call      : in  string            := "" -- External proc_call. Overwrite if called from another BFM procedure ) </font> <font id="function_return">return ()</font>
</br>**Description**
----------------------------------------
 uart_receive
----------------------------------------
 - This procedure reads data from the UART DUT and returns it in 'data_value'
 - The RX configuration can be set in the config parameter

- uart_expect <font id="function_arguments">( constant data_exp           : in std_logic_vector;<br><span style="padding-left:20px"> constant msg                : in string;<br><span style="padding-left:20px"> signal rx                   : in std_logic;<br><span style="padding-left:20px"> signal terminate_loop       : in std_logic;<br><span style="padding-left:20px"> constant max_receptions     : in natural           := 1;<br><span style="padding-left:20px"> constant timeout            : in time              := -1 ns;<br><span style="padding-left:20px"> constant alert_level        : in t_alert_level     := ERROR;<br><span style="padding-left:20px"> constant config             : in t_uart_bfm_config := C_UART_BFM_CONFIG_DEFAULT;<br><span style="padding-left:20px"> constant scope              : in string            := C_SCOPE;<br><span style="padding-left:20px"> constant msg_id_panel       : in t_msg_id_panel    := shared_msg_id_panel ) </font> <font id="function_return">return ()</font>
</br>**Description**
----------------------------------------
 uart_expect
----------------------------------------
 - This procedure reads data from the UART DUT and compares it to the data in
   'data_exp'.
 - If the read data is inconsistent with the 'data_exp' data, a new read will
   be performed, and the new read data will be compared with 'data_exp'.
   This process will continue untill one of the following conditions are met:
     a) The read data is equal to the expected data
     b) The number of reads equal 'max_receptions'
     c) The time spent reading is equal to the 'timeout'
 - If 'timeout' is set to 0, it will be interpreted as no timeout
 - If 'max_receptions' is set to 0, it will be interpreted as no limitation on number of reads
 - The RX configuration can be set in the config parameter

- odd_parity <font id="function_arguments">( constant data : std_logic_vector(7 downto 0)) </font> <font id="function_return">return std_logic </font>
</br>**Description**
----------------------------------------
 odd_parity
----------------------------------------
 - This function checks if the data parity is odd or even
 - If the number of '1' in the 'data' input is odd, '1' will be returned
 - If the number of '1' in the 'data' input is even, '0' will be returned

