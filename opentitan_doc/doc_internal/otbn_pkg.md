# Package: otbn_pkg

## Description

Copyright lowRISC contributors.
 Licensed under the Apache License, Version 2.0, see LICENSE for details.
 SPDX-License-Identifier: Apache-2.0
 

## Constants

| Name                   | Type                       | Value                                                                 | Description                                                                                                                                                                                                                                                                                                     |
| ---------------------- | -------------------------- | --------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| WLEN                   | int                        | 256                                                                   |                                                                                                                                                                                                                                                                                                                 |
| ExtWLEN                | int                        | WLEN * 39 / 32                                                        | "Extended" WLEN: the size of the datapath with added integrity bits                                                                                                                                                                                                                                             |
| BaseIntgWidth          | int                        | 39                                                                    | Width of base (32b) data path with added integrity bits                                                                                                                                                                                                                                                         |
| BaseWordsPerWLEN       | int                        | WLEN / 32                                                             | Number of 32-bit words per WLEN                                                                                                                                                                                                                                                                                 |
| NFlagGroups            | int                        | 2                                                                     | Number of flag groups                                                                                                                                                                                                                                                                                           |
| GprAw                  | int                        | 5                                                                     | Width of the GPR index/address                                                                                                                                                                                                                                                                                  |
| NGpr                   | int                        | 2 ** GprAw                                                            | Number of General Purpose Registers (GPRs)                                                                                                                                                                                                                                                                      |
| WdrAw                  | int                        | 5                                                                     | Width of the WDR index/address                                                                                                                                                                                                                                                                                  |
| NWdr                   | int                        | 2 ** WdrAw                                                            | Number of Wide Data Registers (WDRs)                                                                                                                                                                                                                                                                            |
| EdnDataWidth           | int                        | 256                                                                   | Width of entropy input                                                                                                                                                                                                                                                                                          |
| AlertFatal             | int                        | 0                                                                     | Toplevel constants ============================================================================                                                                                                                                                                                                                 |
| AlertRecov             | int                        | 1                                                                     |                                                                                                                                                                                                                                                                                                                 |
| CsrNumWidth            | int                        | 12                                                                    | Control and Status Registers (CSRs)                                                                                                                                                                                                                                                                             |
| NWsr                   | int                        | 4                                                                     | Number of WSRs                                                                                                                                                                                                                                                                                                  |
| WsrNumWidth            | int                        | $clog2(NWsr)                                                          |                                                                                                                                                                                                                                                                                                                 |
| NIspr                  | int                        | 5                                                                     | Internal Special Purpose Registers (ISPRs) CSRs and WSRs have some overlap into what they map into. ISPRs are the actual registers in the design which CSRs and WSRs are mapped on to.                                                                                                                          |
| IsprNumWidth           | int                        | $clog2(NIspr)                                                         |                                                                                                                                                                                                                                                                                                                 |
| FlagsWidth             | int                        | $bits(flags_t)                                                        |                                                                                                                                                                                                                                                                                                                 |
| UrndLfsrWidth          | int                        | 256                                                                   | URNG PRNG default LFSR seed and permutation A single default seed is split into 64 bit chunks, a separate LFSR is used for each chunk. All LFSR chunks use the same permutation. These LFSR parameters have been generated with $ ./util/design/gen-lfsr-seed.py --width 256 --seed 2840984437 --prefix "Urnd"  |
| urnd_lfsr_seed_t       | urnd_lfsr_seed_t           | 256'h84ddfadaf7e1134d70aa1c59de6197ff25a4fe335d095f1e2cba89acbe4a07e9 |                                                                                                                                                                                                                                                                                                                 |
| UrndChunkLfsrWidth     | int                        | 64                                                                    | These LFSR parameters have been generated with $ ./util/design/gen-lfsr-seed.py --width 64 --seed 2840984437 --prefix "UrndChunk"                                                                                                                                                                               |
| urnd_chunk_lfsr_perm_t | urnd_chunk_lfsr_perm_t     |                                                                       |                                                                                                                                                                                                                                                                                                                 |
| otp_ctrl_pkg           | otp_ctrl_pkg::otbn_key_t   | 128'h14e8cecae3040d5e12286bb3cc113298                                 |                                                                                                                                                                                                                                                                                                                 |
| otp_ctrl_pkg           | otp_ctrl_pkg::otbn_nonce_t | 64'hf79780bc735f3843                                                  |                                                                                                                                                                                                                                                                                                                 |
## Types

| Name                    | Type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Description                                                                                                                                                                |
| ----------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| regfile_e               | enum integer {<br><span style="padding-left:20px">     RegFileFF    = 0,<br><span style="padding-left:20px">      RegFileFPGA  = 1     }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Register file implementation selection enum.                                                                                                                               |
| err_bits_t              | struct packed {<br><span style="padding-left:20px">     logic fatal_reg;<br><span style="padding-left:20px">     logic fatal_dmem;<br><span style="padding-left:20px">     logic fatal_imem;<br><span style="padding-left:20px">     logic loop;<br><span style="padding-left:20px">     logic illegal_insn;<br><span style="padding-left:20px">     logic call_stack;<br><span style="padding-left:20px">     logic bad_insn_addr;<br><span style="padding-left:20px">     logic bad_data_addr;<br><span style="padding-left:20px">   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Note: These errors are duplicated in the register HJSON (../data/otbn.hjson), the ISS (../dv/otbnsim/sim/alert.py), and the DIF. If updating them here, update those too.  |
| insn_subset_e           | enum logic {<br><span style="padding-left:20px">     InsnSubsetBase = 1'b0,<br><span style="padding-left:20px">       InsnSubsetBignum = 1'b1    }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Constants =====================================================================================                                                                            |
| insn_opcode_e           | enum logic [6:0] {<br><span style="padding-left:20px">     InsnOpcodeBaseLoad       = 7'h03,<br><span style="padding-left:20px">     InsnOpcodeBaseMemMisc    = 7'h0f,<br><span style="padding-left:20px">     InsnOpcodeBaseOpImm      = 7'h13,<br><span style="padding-left:20px">     InsnOpcodeBaseAuipc      = 7'h17,<br><span style="padding-left:20px">     InsnOpcodeBaseStore      = 7'h23,<br><span style="padding-left:20px">     InsnOpcodeBaseOp         = 7'h33,<br><span style="padding-left:20px">     InsnOpcodeBaseLui        = 7'h37,<br><span style="padding-left:20px">     InsnOpcodeBaseBranch     = 7'h63,<br><span style="padding-left:20px">     InsnOpcodeBaseJalr       = 7'h67,<br><span style="padding-left:20px">     InsnOpcodeBaseJal        = 7'h6f,<br><span style="padding-left:20px">     InsnOpcodeBaseSystem     = 7'h73,<br><span style="padding-left:20px">     InsnOpcodeBignumMisc     = 7'h0B,<br><span style="padding-left:20px">     InsnOpcodeBignumArith    = 7'h2B,<br><span style="padding-left:20px">     InsnOpcodeBignumMulqacc  = 7'h3B,<br><span style="padding-left:20px">     InsnOpcodeBignumBaseMisc = 7'h7B   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Opcodes (field [6:0] in the instruction), matching the RISC-V specification for the base instruction subset.                                                               |
| alu_op_base_e           | enum logic [3:0] {<br><span style="padding-left:20px">     AluOpBaseAdd,<br><span style="padding-left:20px">     AluOpBaseSub,<br><span style="padding-left:20px">      AluOpBaseXor,<br><span style="padding-left:20px">     AluOpBaseOr,<br><span style="padding-left:20px">     AluOpBaseAnd,<br><span style="padding-left:20px">     AluOpBaseNot,<br><span style="padding-left:20px">      AluOpBaseSra,<br><span style="padding-left:20px">     AluOpBaseSrl,<br><span style="padding-left:20px">     AluOpBaseSll   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                            |
| alu_op_bignum_e         | enum logic [3:0] {<br><span style="padding-left:20px">     AluOpBignumAdd,<br><span style="padding-left:20px">     AluOpBignumAddc,<br><span style="padding-left:20px">     AluOpBignumAddm,<br><span style="padding-left:20px">      AluOpBignumSub,<br><span style="padding-left:20px">     AluOpBignumSubb,<br><span style="padding-left:20px">     AluOpBignumSubm,<br><span style="padding-left:20px">      AluOpBignumRshi,<br><span style="padding-left:20px">      AluOpBignumXor,<br><span style="padding-left:20px">     AluOpBignumOr,<br><span style="padding-left:20px">     AluOpBignumAnd,<br><span style="padding-left:20px">     AluOpBignumNot   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | TODO: Can we arrange this to simplify decoding logic?                                                                                                                      |
| comparison_op_base_e    | enum logic {<br><span style="padding-left:20px">     ComparisonOpBaseEq,<br><span style="padding-left:20px">     ComparisonOpBaseNeq   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |                                                                                                                                                                            |
| op_a_sel_e              | enum logic [1:0] {<br><span style="padding-left:20px">     OpASelRegister  = 'd0,<br><span style="padding-left:20px">     OpASelZero = 'd1,<br><span style="padding-left:20px">     OpASelCurrPc = 'd2   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Operand a source selection                                                                                                                                                 |
| op_b_sel_e              | enum logic {<br><span style="padding-left:20px">     OpBSelRegister  = 'd0,<br><span style="padding-left:20px">     OpBSelImmediate = 'd1   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Operand b source selection                                                                                                                                                 |
| imm_b_sel_base_e        | enum logic [2:0] {<br><span style="padding-left:20px">     ImmBaseBI,<br><span style="padding-left:20px">     ImmBaseBS,<br><span style="padding-left:20px">     ImmBaseBB,<br><span style="padding-left:20px">     ImmBaseBU,<br><span style="padding-left:20px">     ImmBaseBJ,<br><span style="padding-left:20px">     ImmBaseBL,<br><span style="padding-left:20px">     ImmBaseBX   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Immediate b selection for base ISA                                                                                                                                         |
| shamt_sel_bignum_e      | enum logic [1:0] {<br><span style="padding-left:20px">     ShamtSelBignumA,<br><span style="padding-left:20px">     ShamtSelBignumS,<br><span style="padding-left:20px">     ShamtSelBignumZero   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Shift amount select for bignum ISA                                                                                                                                         |
| rf_wd_sel_e             | enum logic [2:0] {<br><span style="padding-left:20px">     RfWdSelEx,<br><span style="padding-left:20px">     RfWdSelNextPc,<br><span style="padding-left:20px">     RfWdSelLsu,<br><span style="padding-left:20px">     RfWdSelIspr,<br><span style="padding-left:20px">     RfWdSelIncr,<br><span style="padding-left:20px">     RfWdSelMac,<br><span style="padding-left:20px">     RfWdSelMovSel   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Regfile write data selection                                                                                                                                               |
| csr_e                   | enum logic [CsrNumWidth-1:0] {<br><span style="padding-left:20px">     CsrFg0         = 12'h7C0,<br><span style="padding-left:20px">     CsrFg1         = 12'h7C1,<br><span style="padding-left:20px">     CsrFlags       = 12'h7C8,<br><span style="padding-left:20px">     CsrMod0        = 12'h7D0,<br><span style="padding-left:20px">     CsrMod1        = 12'h7D1,<br><span style="padding-left:20px">     CsrMod2        = 12'h7D2,<br><span style="padding-left:20px">     CsrMod3        = 12'h7D3,<br><span style="padding-left:20px">     CsrMod4        = 12'h7D4,<br><span style="padding-left:20px">     CsrMod5        = 12'h7D5,<br><span style="padding-left:20px">     CsrMod6        = 12'h7D6,<br><span style="padding-left:20px">     CsrMod7        = 12'h7D7,<br><span style="padding-left:20px">     CsrRnd         = 12'hFC0,<br><span style="padding-left:20px">     CsrRndPrefetch = 12'hFC1,<br><span style="padding-left:20px">     CsrUrnd        = 12'hFC2   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                                                                                                                                                                            |
| wsr_e                   | enum logic [WsrNumWidth-1:0] {<br><span style="padding-left:20px">     WsrMod   = 'd0,<br><span style="padding-left:20px">     WsrRnd   = 'd1,<br><span style="padding-left:20px">     WsrAcc   = 'd2,<br><span style="padding-left:20px">     WsrUrnd  = 'd3   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |                                                                                                                                                                            |
| ispr_e                  | enum logic [IsprNumWidth-1:0] {<br><span style="padding-left:20px">     IsprMod   = 'd0,<br><span style="padding-left:20px">     IsprRnd   = 'd1,<br><span style="padding-left:20px">     IsprAcc   = 'd2,<br><span style="padding-left:20px">     IsprFlags = 'd3,<br><span style="padding-left:20px">     IsprUrnd  = 'd4   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                            |
| flag_group_t            | logic [$clog2(NFlagGroups)-1:0]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                            |
| flags_t                 | struct packed {<br><span style="padding-left:20px">     logic Z;<br><span style="padding-left:20px">     logic L;<br><span style="padding-left:20px">     logic M;<br><span style="padding-left:20px">     logic C;<br><span style="padding-left:20px">   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                                                                                                                                                                            |
| flag_e                  | enum logic [$clog2(FlagsWidth)-1:0] {<br><span style="padding-left:20px">     FlagC = 'd0,<br><span style="padding-left:20px">     FlagM = 'd1,<br><span style="padding-left:20px">     FlagL = 'd2,<br><span style="padding-left:20px">     FlagZ = 'd3   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                            |
| insn_dec_shared_t       | struct packed {<br><span style="padding-left:20px">     insn_subset_e   subset;<br><span style="padding-left:20px">     logic           ecall_insn;<br><span style="padding-left:20px">     logic           ld_insn;<br><span style="padding-left:20px">     logic           st_insn;<br><span style="padding-left:20px">     logic           branch_insn;<br><span style="padding-left:20px">     logic           jump_insn;<br><span style="padding-left:20px">     logic           loop_insn;<br><span style="padding-left:20px">     logic           ispr_rd_insn;<br><span style="padding-left:20px">     logic           ispr_wr_insn;<br><span style="padding-left:20px">     logic           ispr_rs_insn;<br><span style="padding-left:20px">   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                            |
| insn_dec_base_t         | struct packed {<br><span style="padding-left:20px">     logic [4:0]          d;<br><span style="padding-left:20px">                  logic [4:0]          a;<br><span style="padding-left:20px">                  logic [4:0]          b;<br><span style="padding-left:20px">                  logic [31:0]         i;<br><span style="padding-left:20px">                  alu_op_base_e        alu_op;<br><span style="padding-left:20px">     comparison_op_base_e comparison_op;<br><span style="padding-left:20px">     op_a_sel_e           op_a_sel;<br><span style="padding-left:20px">     op_b_sel_e           op_b_sel;<br><span style="padding-left:20px">     logic                rf_ren_a;<br><span style="padding-left:20px">     logic                rf_ren_b;<br><span style="padding-left:20px">     logic                rf_we;<br><span style="padding-left:20px">     rf_wd_sel_e          rf_wdata_sel;<br><span style="padding-left:20px">     logic [11:0]         loop_bodysize;<br><span style="padding-left:20px">     logic                loop_immediate;<br><span style="padding-left:20px">   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                                                                                                                                                                            |
| insn_dec_bignum_t       | struct packed {<br><span style="padding-left:20px">     logic [WdrAw-1:0]        d;<br><span style="padding-left:20px">                logic [WdrAw-1:0]        a;<br><span style="padding-left:20px">                logic [WdrAw-1:0]        b;<br><span style="padding-left:20px">                logic [WLEN-1:0]         i;<br><span style="padding-left:20px">                 logic                    rf_a_indirect;<br><span style="padding-left:20px">                                                   logic                    rf_b_indirect;<br><span style="padding-left:20px">                                                   logic                    rf_d_indirect;<br><span style="padding-left:20px">                                                    logic                    d_inc;<br><span style="padding-left:20px">                                                               logic                    a_inc;<br><span style="padding-left:20px">                                                               logic                    a_wlen_word_inc;<br><span style="padding-left:20px">                                                     logic                    b_inc;<br><span style="padding-left:20px">                                                                     logic [$clog2(WLEN)-1:0] alu_shift_amt;<br><span style="padding-left:20px">        logic                    alu_shift_right;<br><span style="padding-left:20px">       flag_group_t             alu_flag_group;<br><span style="padding-left:20px">     flag_e                   alu_sel_flag;<br><span style="padding-left:20px">     logic                    alu_flag_en;<br><span style="padding-left:20px">     logic                    mac_flag_en;<br><span style="padding-left:20px">     alu_op_bignum_e          alu_op;<br><span style="padding-left:20px">     op_b_sel_e               alu_op_b_sel;<br><span style="padding-left:20px">      logic [1:0]              mac_op_a_qw_sel;<br><span style="padding-left:20px">     logic [1:0]              mac_op_b_qw_sel;<br><span style="padding-left:20px">     logic                    mac_wr_hw_sel_upper;<br><span style="padding-left:20px">     logic [1:0]              mac_pre_acc_shift;<br><span style="padding-left:20px">     logic                    mac_zero_acc;<br><span style="padding-left:20px">     logic                    mac_shift_out;<br><span style="padding-left:20px">     logic                    mac_en;<br><span style="padding-left:20px">      logic                    rf_we;<br><span style="padding-left:20px">     rf_wd_sel_e              rf_wdata_sel;<br><span style="padding-left:20px">     logic                    rf_ren_a;<br><span style="padding-left:20px">     logic                    rf_ren_b;<br><span style="padding-left:20px">      logic                    sel_insn;<br><span style="padding-left:20px">   } |                                                                                                                                                                            |
| alu_base_operation_t    | struct packed {<br><span style="padding-left:20px">     alu_op_base_e     op;<br><span style="padding-left:20px">     logic [31:0] operand_a;<br><span style="padding-left:20px">     logic [31:0] operand_b;<br><span style="padding-left:20px">   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                                                                            |
| alu_base_comparison_t   | struct packed {<br><span style="padding-left:20px">     comparison_op_base_e op;<br><span style="padding-left:20px">     logic [31:0] operand_a;<br><span style="padding-left:20px">     logic [31:0] operand_b;<br><span style="padding-left:20px">   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |                                                                                                                                                                            |
| alu_bignum_operation_t  | struct packed {<br><span style="padding-left:20px">     alu_op_bignum_e op;<br><span style="padding-left:20px">     logic [WLEN-1:0]         operand_a;<br><span style="padding-left:20px">     logic [WLEN-1:0]         operand_b;<br><span style="padding-left:20px">     logic                    shift_right;<br><span style="padding-left:20px">     logic [$clog2(WLEN)-1:0] shift_amt;<br><span style="padding-left:20px">     flag_group_t             flag_group;<br><span style="padding-left:20px">     flag_e                   sel_flag;<br><span style="padding-left:20px">     logic                    alu_flag_en;<br><span style="padding-left:20px">     logic                    mac_flag_en;<br><span style="padding-left:20px">   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                            |
| mac_bignum_operation_t  | struct packed {<br><span style="padding-left:20px">     logic [WLEN-1:0] operand_a;<br><span style="padding-left:20px">     logic [WLEN-1:0] operand_b;<br><span style="padding-left:20px">     logic [1:0]      operand_a_qw_sel;<br><span style="padding-left:20px">     logic [1:0]      operand_b_qw_sel;<br><span style="padding-left:20px">     logic            wr_hw_sel_upper;<br><span style="padding-left:20px">     logic [1:0]      pre_acc_shift_imm;<br><span style="padding-left:20px">     logic            zero_acc;<br><span style="padding-left:20px">     logic            shift_acc;<br><span style="padding-left:20px">   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |                                                                                                                                                                            |
| otbn_state_e            | enum logic [1:0] {<br><span style="padding-left:20px">     OtbnStateHalt,<br><span style="padding-left:20px">     OtbnStateUrndRefresh,<br><span style="padding-left:20px">     OtbnStateRun,<br><span style="padding-left:20px">     OtbnStateStall   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | States for controller state machine                                                                                                                                        |
| otbn_start_stop_state_e | enum logic [1:0] {<br><span style="padding-left:20px">     OtbnStartStopStateHalt,<br><span style="padding-left:20px">     OtbnStartStopStateUrndRefresh,<br><span style="padding-left:20px">     OtbnStartStopStateRunning   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                            |
| urnd_lfsr_seed_t        | logic [UrndLfsrWidth-1:0]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                            |
| urnd_chunk_lfsr_perm_t  | logic [UrndChunkLfsrWidth-1:0][$clog2(UrndChunkLfsrWidth)-1:0]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |                                                                                                                                                                            |
| otbn_dmem_nonce_t       | logic [63:0]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                            |
| otbn_imem_nonce_t       | logic [63:0]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                            |
