
<style>
  table {
    width:70%;
    margin-left: auto;
    margin-right: auto
  }
  svg {
    width:68%;
    height:30%;
    display:block;  
    margin-left: auto;
    margin-right: auto
  }
  h1, h2, h3, h4 {
    margin-left:1.5%;
    width:98%;
    font-weight:bold
  }
  code {
    color:#545253;
  }
  p {
    width: 98%;
    color:black;
    margin-top:5px;
    margin-bottom:5px 
  }
  * {
    color:black;
    line-height: 1.6;
  }
  li{
    margin: 20px 0;
  }
  #function_return{
    font-weight: bold;
    color:green;
  }
  #teroshdl_description, li {
    width: 95%;
    margin-left:2%;
    margin-right:2%;
  }
  #function_arguments{
    color:black;
  }
  #descriptions{
    width: 90%;
    margin-left:5.5%;
    margin-right:3%;
  }
  div.templateTerosHDL {
    background-color: white;
    position:absolute;
  }
  td, th {
    padding:2px; 
    border: 1px solid grey;
  }
  th {
    background-color: #ffd78c;
  }
  tr:hover {
    background-color: #ddd;
  }
  tr:nth-child(even){
    background-color: #f2f2f2;
  }
</style>
<div id="teroshdl" class='templateTerosHDL'>
<a id=otp_ctrl_scrmbl><h1 id="entity-otp_ctrl_scrmbl">Entity: otp_ctrl_scrmbl</h1></a><h2 id="diagram">Diagram</h2><p><svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" viewBox="0 0 845 190"><svg id="SvgjsSvg1002" width="2" height="0" focusable="false" style="overflow:hidden;top:-100%;left:-100%;position:absolute;opacity:0"><polyline id="SvgjsPolyline1003" points="265,0 280,0"></polyline><path id="SvgjsPath1004" d="M0 0 "></path></svg><rect id="SvgjsRect1006" width="300" height="170" fill="black" x="280" y="15"></rect><rect id="SvgjsRect1007" width="296" height="165" fill="#fdfd96" x="282" y="17"></rect><text id="SvgjsText1008" font-family="Helvetica" x="260" y="9.3015625" font-size="20" text-anchor="end" family="Helvetica" size="20" anchor="end" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1009" dy="26" x="260" svgjs:data="{&quot;newLined&quot;:true}">    </tspan></text><text id="SvgjsText1010" font-family="Helvetica" x="295" y="9.3015625" font-size="20" text-anchor="start" family="Helvetica" size="20" anchor="start" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1011" dy="26" x="295" svgjs:data="{&quot;newLined&quot;:true}">   clk_i </tspan></text><line id="SvgjsLine1012" x1="265" y1="30" x2="280" y2="30" stroke-linecap="rec" stroke="black" stroke-width="5"></line><text id="SvgjsText1013" font-family="Helvetica" x="260" y="29.3015625" font-size="20" text-anchor="end" family="Helvetica" size="20" anchor="end" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1014" dy="26" x="260" svgjs:data="{&quot;newLined&quot;:true}">    </tspan></text><text id="SvgjsText1015" font-family="Helvetica" x="295" y="29.3015625" font-size="20" text-anchor="start" family="Helvetica" size="20" anchor="start" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1016" dy="26" x="295" svgjs:data="{&quot;newLined&quot;:true}">   rst_ni </tspan></text><line id="SvgjsLine1017" x1="265" y1="50" x2="280" y2="50" stroke-linecap="rec" stroke="black" stroke-width="5"></line><text id="SvgjsText1018" font-family="Helvetica" x="260" y="49.3015625" font-size="20" text-anchor="end" family="Helvetica" size="20" anchor="end" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1019" dy="26" x="260" svgjs:data="{&quot;newLined&quot;:true}">   otp_scrmbl_cmd_e </tspan></text><text id="SvgjsText1020" font-family="Helvetica" x="295" y="49.3015625" font-size="20" text-anchor="start" family="Helvetica" size="20" anchor="start" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1021" dy="26" x="295" svgjs:data="{&quot;newLined&quot;:true}">   cmd_i </tspan></text><line id="SvgjsLine1022" x1="265" y1="70" x2="280" y2="70" stroke-linecap="rec" stroke="black" stroke-width="5"></line><text id="SvgjsText1023" font-family="Helvetica" x="260" y="69.3015625" font-size="20" text-anchor="end" family="Helvetica" size="20" anchor="end" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1024" dy="26" x="260" svgjs:data="{&quot;newLined&quot;:true}">   digest_mode_e </tspan></text><text id="SvgjsText1025" font-family="Helvetica" x="295" y="69.3015625" font-size="20" text-anchor="start" family="Helvetica" size="20" anchor="start" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1026" dy="26" x="295" svgjs:data="{&quot;newLined&quot;:true}">   mode_i </tspan></text><line id="SvgjsLine1027" x1="265" y1="90" x2="280" y2="90" stroke-linecap="rec" stroke="black" stroke-width="5"></line><text id="SvgjsText1028" font-family="Helvetica" x="260" y="89.3015625" font-size="20" text-anchor="end" family="Helvetica" size="20" anchor="end" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1029" dy="26" x="260" svgjs:data="{&quot;newLined&quot;:true}">   [ConstSelWidth-1:0] </tspan></text><text id="SvgjsText1030" font-family="Helvetica" x="295" y="89.3015625" font-size="20" text-anchor="start" family="Helvetica" size="20" anchor="start" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1031" dy="26" x="295" svgjs:data="{&quot;newLined&quot;:true}">   sel_i </tspan></text><line id="SvgjsLine1032" x1="265" y1="110" x2="280" y2="110" stroke-linecap="rec" stroke="black" stroke-width="5"></line><text id="SvgjsText1033" font-family="Helvetica" x="260" y="109.3015625" font-size="20" text-anchor="end" family="Helvetica" size="20" anchor="end" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1034" dy="26" x="260" svgjs:data="{&quot;newLined&quot;:true}">   [ScrmblBlockWidth-1:0] </tspan></text><text id="SvgjsText1035" font-family="Helvetica" x="295" y="109.3015625" font-size="20" text-anchor="start" family="Helvetica" size="20" anchor="start" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1036" dy="26" x="295" svgjs:data="{&quot;newLined&quot;:true}">   data_i </tspan></text><line id="SvgjsLine1037" x1="265" y1="130" x2="280" y2="130" stroke-linecap="rec" stroke="black" stroke-width="5"></line><text id="SvgjsText1038" font-family="Helvetica" x="260" y="129.3015625" font-size="20" text-anchor="end" family="Helvetica" size="20" anchor="end" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1039" dy="26" x="260" svgjs:data="{&quot;newLined&quot;:true}">    </tspan></text><text id="SvgjsText1040" font-family="Helvetica" x="295" y="129.3015625" font-size="20" text-anchor="start" family="Helvetica" size="20" anchor="start" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1041" dy="26" x="295" svgjs:data="{&quot;newLined&quot;:true}">   valid_i </tspan></text><line id="SvgjsLine1042" x1="265" y1="150" x2="280" y2="150" stroke-linecap="rec" stroke="black" stroke-width="5"></line><text id="SvgjsText1043" font-family="Helvetica" x="260" y="149.3015625" font-size="20" text-anchor="end" family="Helvetica" size="20" anchor="end" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1044" dy="26" x="260" svgjs:data="{&quot;newLined&quot;:true}">    </tspan></text><text id="SvgjsText1045" font-family="Helvetica" x="295" y="149.3015625" font-size="20" text-anchor="start" family="Helvetica" size="20" anchor="start" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1046" dy="26" x="295" svgjs:data="{&quot;newLined&quot;:true}">   escalate_en_i </tspan></text><line id="SvgjsLine1047" x1="265" y1="170" x2="280" y2="170" stroke-linecap="rec" stroke="black" stroke-width="5"></line><text id="SvgjsText1048" font-family="Helvetica" x="600" y="9.3015625" font-size="20" text-anchor="start" family="Helvetica" size="20" anchor="start" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1049" dy="26" x="600" svgjs:data="{&quot;newLined&quot;:true}">    </tspan></text><text id="SvgjsText1050" font-family="Helvetica" x="565" y="9.3015625" font-size="20" text-anchor="end" family="Helvetica" size="20" anchor="end" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1051" dy="26" x="565" svgjs:data="{&quot;newLined&quot;:true}">   ready_o </tspan></text><line id="SvgjsLine1052" x1="580" y1="30" x2="595" y2="30" stroke-linecap="rec" stroke="black" stroke-width="5"></line><text id="SvgjsText1053" font-family="Helvetica" x="600" y="29.3015625" font-size="20" text-anchor="start" family="Helvetica" size="20" anchor="start" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1054" dy="26" x="600" svgjs:data="{&quot;newLined&quot;:true}">   [ScrmblBlockWidth-1:0] </tspan></text><text id="SvgjsText1055" font-family="Helvetica" x="565" y="29.3015625" font-size="20" text-anchor="end" family="Helvetica" size="20" anchor="end" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1056" dy="26" x="565" svgjs:data="{&quot;newLined&quot;:true}">   data_o </tspan></text><line id="SvgjsLine1057" x1="580" y1="50" x2="595" y2="50" stroke-linecap="rec" stroke="black" stroke-width="5"></line><text id="SvgjsText1058" font-family="Helvetica" x="600" y="49.3015625" font-size="20" text-anchor="start" family="Helvetica" size="20" anchor="start" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1059" dy="26" x="600" svgjs:data="{&quot;newLined&quot;:true}">    </tspan></text><text id="SvgjsText1060" font-family="Helvetica" x="565" y="49.3015625" font-size="20" text-anchor="end" family="Helvetica" size="20" anchor="end" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1061" dy="26" x="565" svgjs:data="{&quot;newLined&quot;:true}">   valid_o </tspan></text><line id="SvgjsLine1062" x1="580" y1="70" x2="595" y2="70" stroke-linecap="rec" stroke="black" stroke-width="5"></line><text id="SvgjsText1063" font-family="Helvetica" x="600" y="69.3015625" font-size="20" text-anchor="start" family="Helvetica" size="20" anchor="start" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1064" dy="26" x="600" svgjs:data="{&quot;newLined&quot;:true}">    </tspan></text><text id="SvgjsText1065" font-family="Helvetica" x="565" y="69.3015625" font-size="20" text-anchor="end" family="Helvetica" size="20" anchor="end" svgjs:data="{&quot;leading&quot;:&quot;1.3&quot;}"><tspan id="SvgjsTspan1066" dy="26" x="565" svgjs:data="{&quot;newLined&quot;:true}">   fsm_err_o </tspan></text><line id="SvgjsLine1067" x1="580" y1="90" x2="595" y2="90" stroke-linecap="rec" stroke="black" stroke-width="5"></line></svg></p><h2 id="description">Description</h2><div id="teroshdl_description"><p>Copyright lowRISC contributors. Licensed under the Apache License, Version 2.0, see LICENSE for details. SPDX-License-Identifier: Apache-2.0 This module contains the scrambling datapath for the OTP controller. It basically consists of two single-round PRESENT primitives (one for encryption and one for decryption mode), a counter with a simple FSM and four working registers, as listed below. key_state_q (128bit): working register to hold the round key (needed for the key schedule). data_state_q (64bit): working register to hold the data state in between rounds. data_shadow_q (64bit): shadow register for holding a second 64bit block of input data. This is used to form a 128bit data block for the digest mode, which has a block size of 128bit. digest_state_q (64bit): register to hold the digest state in between digest updates. Technically, this is not needed when the data for the digest is fed into this block back-to-back. However, the partition integrity checks require that it is possible to interleave encryption operations and digest update steps, hence an additional state register is needed, as otherwise the digest state would be lost. The scrambling datapath is arranged such that it can also be used for calculating a digest using the encryption primitive in a Merkle-Damgard construction. To that end, the PRESENT block cipher is turned into a one way function according to the Davies-Meyer scheme. Note however that this makes the digest block size 128bit wide, since the Merkle-Damgard construction leverages the cipher key input to ingest data. The scrambling datapath exposes a few simple commands and the FSM hides the complexity of steering the appropriate muxes and keeping track of the cipher rounds. These commands are briefly explained below. Decrypt: This decrypts the data block provided via data_i with the key at index sel_i. Encrypt: This encrypts the data block provided via data_i with the key at index sel_i. In addition, this command copies the prvious result into a shadow register before the first encryption round for later use in the digest (see description further below). This enables interleaved encrypt/digest operation needed for the integrity checks of the secret partitions. LoadShadow: In "StandardMode", the LoadShadow command loads the data provided via data_i into a shadow register that is mapped to the lower 64bit of the 128bit digest input data block. In "ChainedMode", this command copies the contents of the data state register into the shadow register. DigestInit: This ensures that the digest initialization vector (IV) is selected upon the next call of the Digest command. Also, mode_i can be used to set the digest mode. If mode_i is set to "StandardMode", the data to be digested has to be provided via data_i and LoadShadow. If mode_i is set to "ChainedMode", the digest input is formed by concatenating the results of the revious two encryption commands. Digest: In "StandardMode", this command concatenates the data input supplied via data_i with the shadow register in order to form a 128bit block ({data_i, data_shadow_q}). This block is then used to encrypt the digest state. In "ChainedMode" digest mode, the 128bit block to be digested is formed by concatenating {data_state_q, data_shadow_q}. If a DigestInit command has been executed right before calling Digest, the IV selected with sel_i is used to initialize the state. DigestFinalize: This command encrypts the digest state with the finalization constant selected by sel_i in order to form the final digest. References: - <a href="https://docs.opentitan.org/hw/ip/otp_ctrl/doc/index.html#design-details">https://docs.opentitan.org/hw/ip/otp_ctrl/doc/index.html#design-details</a></p><ul><li><a href="https://docs.opentitan.org/hw/ip/prim/doc/prim_present/">https://docs.opentitan.org/hw/ip/prim/doc/prim_present/</a></li><li><a href="https://en.wikipedia.org/wiki/Merkle-Damgard_construction">https://en.wikipedia.org/wiki/Merkle-Damgard_construction</a></li><li><a href="https://en.wikipedia.org/wiki/One-way_compression_function#Davies%E2%80%93Meyer">https://en.wikipedia.org/wiki/One-way_compression_function#Davies%E2%80%93Meyer</a></li><li><a href="https://en.wikipedia.org/wiki/PRESENT">https://en.wikipedia.org/wiki/PRESENT</a></li><li><a href="http://www.lightweightcrypto.org/present/present_ches2007.pdf">http://www.lightweightcrypto.org/present/present_ches2007.pdf</a></li></ul></div><h2 id="ports">Ports</h2>
<table>
<thead>
<tr>
<th id="port_name">Port name</th>
<th id="direction">Direction</th>
<th id="type">Type</th>
<th id="description">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>clk_i</td>
<td>input</td>
<td></td>
<td></td>
</tr>
<tr>
<td>rst_ni</td>
<td>input</td>
<td></td>
<td></td>
</tr>
<tr>
<td>cmd_i</td>
<td>input</td>
<td>otp_scrmbl_cmd_e</td>
<td>input data and command</td>
</tr>
<tr>
<td>mode_i</td>
<td>input</td>
<td>digest_mode_e</td>
<td></td>
</tr>
<tr>
<td>sel_i</td>
<td>input</td>
<td>[ConstSelWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>data_i</td>
<td>input</td>
<td>[ScrmblBlockWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>valid_i</td>
<td>input</td>
<td></td>
<td></td>
</tr>
<tr>
<td>ready_o</td>
<td>output</td>
<td></td>
<td></td>
</tr>
<tr>
<td>data_o</td>
<td>output</td>
<td>[ScrmblBlockWidth-1:0]</td>
<td>output data</td>
</tr>
<tr>
<td>valid_o</td>
<td>output</td>
<td></td>
<td></td>
</tr>
<tr>
<td>escalate_en_i</td>
<td>input</td>
<td></td>
<td>escalation input and FSM error indication</td>
</tr>
<tr>
<td>fsm_err_o</td>
<td>output</td>
<td></td>
<td></td>
</tr>
</tbody>
</table><h2 id="signals">Signals</h2>
<table>
<thead>
<tr>
<th id="name">Name</th>
<th id="type">Type</th>
<th id="description">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>otp_enc_key_lut</td>
<td>logic [2**$clog2(NumScrmblKeys)-1:0][ScrmblKeyWidth-1:0]</td>
<td>Align these arrays to power of 2's to prevent X's in the muxing operations further below.</td>
</tr>
<tr>
<td>otp_dec_key_lut</td>
<td>logic [2**$clog2(NumScrmblKeys)-1:0][ScrmblKeyWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>digest_const_lut</td>
<td>logic [2**$clog2(NumDigestSets)-1:0][ScrmblKeyWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>digest_iv_lut</td>
<td>logic [2**$clog2(NumDigestSets)-1:0][ScrmblBlockWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>idx_state_d</td>
<td>logic [4:0]</td>
<td></td>
</tr>
<tr>
<td>idx_state_q</td>
<td>logic [4:0]</td>
<td></td>
</tr>
<tr>
<td>key_state_d</td>
<td>logic [ScrmblKeyWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>key_state_q</td>
<td>logic [ScrmblKeyWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>data_state_d</td>
<td>logic [ScrmblBlockWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>data_state_q</td>
<td>logic [ScrmblBlockWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>data_shadow_q</td>
<td>logic [ScrmblBlockWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>digest_state_d</td>
<td>logic [ScrmblBlockWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>digest_state_q</td>
<td>logic [ScrmblBlockWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>enc_data_out</td>
<td>logic [ScrmblBlockWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>enc_data_out_xor</td>
<td>logic [ScrmblBlockWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>dec_data_out</td>
<td>logic [ScrmblBlockWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>dec_key_out</td>
<td>logic [ScrmblKeyWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>enc_key_out</td>
<td>logic [ScrmblKeyWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>dec_idx_out</td>
<td>logic [4:0]</td>
<td></td>
</tr>
<tr>
<td>enc_idx_out</td>
<td>logic [4:0]</td>
<td></td>
</tr>
<tr>
<td>otp_digest_const_mux</td>
<td>logic [ScrmblKeyWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>otp_enc_key_mux</td>
<td>logic [ScrmblKeyWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>otp_dec_key_mux</td>
<td>logic [ScrmblKeyWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>otp_digest_iv_mux</td>
<td>logic [ScrmblBlockWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>digest_init</td>
<td>logic</td>
<td></td>
</tr>
<tr>
<td>data_state_sel</td>
<td>data_state_sel_e</td>
<td></td>
</tr>
<tr>
<td>key_state_sel</td>
<td>key_state_sel_e</td>
<td></td>
</tr>
<tr>
<td>data_state_en</td>
<td>logic</td>
<td></td>
</tr>
<tr>
<td>data_shadow_copy</td>
<td>logic</td>
<td></td>
</tr>
<tr>
<td>data_shadow_load</td>
<td>logic</td>
<td></td>
</tr>
<tr>
<td>digest_state_en</td>
<td>logic</td>
<td></td>
</tr>
<tr>
<td>key_state_en</td>
<td>logic</td>
<td></td>
</tr>
<tr>
<td>digest_mode_d</td>
<td>digest_mode_e</td>
<td></td>
</tr>
<tr>
<td>digest_mode_q</td>
<td>digest_mode_e</td>
<td></td>
</tr>
<tr>
<td>state_d</td>
<td>state_e</td>
<td></td>
</tr>
<tr>
<td>state_q</td>
<td>state_e</td>
<td></td>
</tr>
<tr>
<td>cnt_d</td>
<td>logic [CntWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>cnt_q</td>
<td>logic [CntWidth-1:0]</td>
<td></td>
</tr>
<tr>
<td>cnt_clr</td>
<td>logic</td>
<td></td>
</tr>
<tr>
<td>cnt_en</td>
<td>logic</td>
<td></td>
</tr>
<tr>
<td>valid_d</td>
<td>logic</td>
<td></td>
</tr>
<tr>
<td>valid_q</td>
<td>logic</td>
<td></td>
</tr>
<tr>
<td>state_raw_q</td>
<td>logic [StateWidth-1:0]</td>
<td>This primitive is used to place a size-only constraint on the flops in order to prevent FSM state encoding optimizations.</td>
</tr>
</tbody>
</table>
<h2 id="constants">Constants</h2>
<table>
<thead>
<tr>
<th id="name">Name</th>
<th id="type">Type</th>
<th id="value">Value</th>
<th id="description">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>StateWidth</td>
<td>int</td>
<td>9</td>
<td></td>
</tr>
<tr>
<td>CntWidth</td>
<td>int</td>
<td>$clog2(NumPresentRounds+1)</td>
<td></td>
</tr>
<tr>
<td>LastPresentRoundInt</td>
<td>int unsigned</td>
<td>NumPresentRounds - 1</td>
<td></td>
</tr>
<tr>
<td>LastPresentRound</td>
<td>bit [CntWidth-1:0]</td>
<td>undefined</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="types">Types</h2>
<table>
<thead>
<tr>
<th id="name">Name</th>
<th id="type">Type</th>
<th id="description">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>data_state_sel_e</td>
<td>enum logic [2:0] {SelEncDataOut,                             SelDecDataOut,                             SelDigestState,                             SelEncDataOutXor,                             SelDataInput}</td>
<td></td>
</tr>
<tr>
<td>key_state_sel_e</td>
<td>enum logic [2:0] {SelDecKeyOut,                             SelEncKeyOut,                             SelDecKeyInit,                             SelEncKeyInit,                             SelDigestConst,                             SelDigestInput,                             SelDigestChained}</td>
<td></td>
</tr>
<tr>
<td>state_e</td>
<td>enum logic [StateWidth-1:0] {     IdleSt    = 9'b100010111,     DecryptSt = 9'b001010000,     EncryptSt = 9'b011001011,     DigestSt  = 9'b100101000,     ErrorSt   = 9'b010111101   }</td>
<td></td>
</tr>
</tbody>
</table><h2 id="processes">Processes</h2><ul>
<li>p_luts: (  )</li>
</ul><ul>
<li>p_fsm: (  )</li>
</ul><ul>
<li>p_regs: ( @(posedge clk_i or negedge rst_ni) )</li>
</ul><h2 id="instantiations">Instantiations</h2><ul>
<li>u_prim_present_enc: prim_present</li>
</ul><ul>
<li>u_prim_present_dec: prim_present</li>
</ul><ul>
<li>u_state_regs: prim_flop</li>
</ul><br><br><br><br><br><br>